import{r as c,j as t,f as d}from"./index-Bp9WHnKB.js";const y=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});function R({schedule:o}){const[i,h]=c.useState(""),[l,g]=c.useState(!0),u=c.useMemo(()=>{if(!i)return o;const e=l?1:-1;return[...o].sort((s,n)=>{const a=s[i],r=n[i];return a<r?-e:a>r?e:0})},[o,i,l]),[f,j]=c.useState(new Set),p=e=>j(s=>{const n=new Set(s);return n.has(e)?n.delete(e):n.add(e),n}),v=()=>{const e=[["Payment #","Date","Interest Rate","Interest Due","Payment Due","Extra Payments","Principal Paid","Balance","Year","Tax Returned","Cumulative Tax Returned","PMI Active","LTV %"],...u.map(a=>[a.paymentNumber,y(a.paymentDate),a.interestRate.toFixed(2),a.interestDue.toFixed(2),a.paymentAmount.toFixed(2),a.extraPayments.toFixed(2),a.principalPaid.toFixed(2),a.remainingBalance.toFixed(2),a.year,a.taxReturned.toFixed(2),a.cumulativeTaxReturned.toFixed(2),a.pmiActive?"Yes":"No",(a.ltv*100).toFixed(1)])],s=new Blob([e.map(a=>a.join(",")).join(`
`)],{type:"text/csv"}),n=document.createElement("a");n.href=URL.createObjectURL(s),n.download="amortization_schedule.csv",n.click(),URL.revokeObjectURL(n.href)},x=[{label:"#",key:"paymentNumber",description:"Payment number"},{label:"Date",key:"",description:"Payment date"},{label:"Rate",key:"interestRate",description:"Interest rate"},{label:"Interest",key:"interestDue",description:"Interest due"},{label:"Payment",key:"paymentAmount",description:"Payment amount due"},{label:"Extra",key:"extraPayments",description:"Extra payments"},{label:"Principal",key:"principalPaid",description:"Principal paid"},{label:"Balance",key:"remainingBalance",description:"Remaining balance"}],b=e=>{e&&(g(e===i?!l:!0),h(e))},N=(e,s)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),b(s))},w=(e,s)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),p(s))};return t.jsxs("div",{className:"outer-table mt-4 p-2 sm:p-4 w-full mx-auto",role:"region","aria-label":"Amortization Schedule",children:[t.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-4 mb-4",children:[t.jsx("button",{onClick:()=>window.print(),className:"px-3 py-2 sm:px-4 bg-green-600 text-white rounded shadow hover:bg-green-700 focus:ring-2 focus:ring-green-400 focus:outline-none no-print text-sm sm:text-base","aria-label":"Print amortization table",children:"Print Table"}),t.jsx("button",{onClick:v,className:"px-3 py-2 sm:px-4 bg-blue-600 text-white rounded shadow hover:bg-blue-700 focus:ring-2 focus:ring-blue-400 focus:outline-none no-print text-sm sm:text-base","aria-label":"Export amortization schedule to CSV",children:"Export CSV"})]}),t.jsxs("div",{className:"printable",children:[t.jsxs("div",{className:"p-2 sm:p-4 bg-gray-50 border-b",children:[t.jsx("h3",{className:"text-lg font-semibold no-underline p-2 sm:p-4",id:"amort-table-heading",children:"Amortization Schedule"}),t.jsx("p",{className:"text-sm text-gray-500 px-2 sm:px-4",id:"amort-table-desc",children:"Breakdown of every payment over the loan term. Click year headers to expand/collapse."})]}),t.jsx("div",{className:"overflow-x-auto p-2 sm:p-4",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-300","aria-labelledby":"amort-table-heading","aria-describedby":"amort-table-desc",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsx("tr",{children:x.map(({label:e,key:s,description:n})=>t.jsxs("th",{scope:"col",className:"p-2 sm:p-3 text-left text-xs font-semibold text-gray-600 select-none cursor-pointer hover:bg-gray-100 focus:bg-gray-200 focus:outline-none",onClick:()=>b(s),onKeyDown:a=>N(a,s),tabIndex:s?0:-1,role:s?"button":void 0,"aria-sort":s===i?l?"ascending":"descending":void 0,"aria-label":s?`Sort by ${n}`:n,children:[e,s===i&&t.jsx("span",{"aria-hidden":"true",children:l?" ▲":" ▼"})]},e))})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map((e,s,n)=>{const a=s===0||e.year!==n[s-1].year,r=f.has(e.year);return t.jsxs(c.Fragment,{children:[a&&t.jsxs(t.Fragment,{children:[t.jsx("tr",{className:"bg-gray-100 cursor-pointer hover:bg-gray-200 focus-within:bg-gray-200",onClick:()=>p(e.year),onKeyDown:m=>w(m,e.year),tabIndex:0,role:"button","aria-expanded":!r,"aria-label":`${e.year} payments, ${r?"click to expand":"click to collapse"}`,children:t.jsxs("td",{colSpan:x.length,className:"p-2 font-medium",children:[t.jsx("span",{"aria-hidden":"true",children:r?"▶":"▼"})," ",e.year]})}),!r&&t.jsx("tr",{className:"bg-gray-50",children:x.map(({label:m,description:P})=>t.jsx("th",{scope:"col",className:"p-2 sm:p-3 text-left text-xs font-semibold text-gray-600 uppercase","aria-label":P,children:m},`subheader-${e.year}-${m}`))})]}),!r&&t.jsxs("tr",{className:e.pmiActive?"":"bg-green-50",children:[t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:e.paymentNumber}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:y(e.paymentDate)}),t.jsxs("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:[e.interestRate.toFixed(2),"%"]}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:d(e.interestDue)}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:d(e.paymentAmount)}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:d(e.extraPayments)}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:d(e.principalPaid)}),t.jsx("td",{className:"p-2 sm:p-3 text-xs sm:text-sm",children:d(e.remainingBalance)})]})]},e.paymentNumber)})})]})})]})]})}export{R as default};
