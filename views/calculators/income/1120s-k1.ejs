<div class="calc-page">
  <div class="calc-page__header">
    <h1>1120S K-1 Income Calculator</h1>
    <p>Calculate monthly income from S-Corporation K-1 distributions (Schedule K-1, Form 1120S) across up to four K-1 entities.</p>
  </div>

  <div class="calc-page__body">

    <!-- Upload Zone -->
    <div class="calc-section">
      <h2>Upload Schedule K-1 (1120S)</h2>
      <p class="text-muted text-sm" style="margin-bottom: var(--space-sm);">Upload Schedule K-1 pages from Form 1120S to auto-fill fields. Upload one per tax year (max 2).</p>

      <div class="upload-zone" data-upload-type="income-1120s-k1">
        <div class="upload-zone__icon">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
        </div>
        <div class="upload-zone__text">
          <strong>Upload K-1 (1120S)</strong>
          <span>Drop or click to upload a K-1 image or PDF</span>
        </div>
        <input type="file" class="upload-zone__input" accept="image/*,application/pdf" style="display: none;">
        <div class="upload-zone__status"></div>
      </div>

      <!-- JS-rendered document cards -->
      <div id="docCards"></div>
    </div>

    <!-- Policy Explanation -->
    <div class="calc-section">
      <div class="policy-box">
        <h5>S-Corp K-1 Income Policy</h5>
        <p>
          S-Corp K-1 income includes ordinary business income/loss and rental income/loss.
          Unlike partnerships, S-Corps do not have guaranteed payments.
        </p>
      </div>

      <div class="info-note">
        <h5>W-2 Wages Note</h5>
        <p>
          S-Corporation shareholders receive wages via W-2, not guaranteed payments.
          Include W-2 wages from the 1040 calculator separately.
        </p>
      </div>
    </div>

    <!-- K-1 #1 -->
    <div class="calc-section">
      <h2>K-1 #1</h2>
      <p class="text-muted text-sm" style="margin-bottom: var(--space-sm);">Enter line items from the shareholder's Schedule K-1 (Form 1120S).</p>

      <table class="income-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>Line #</th>
            <th>Sign</th>
            <th>Year 1 (Most Recent)</th>
            <th>Year 2 (Prior)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Ordinary Business Income or Loss</td>
            <td class="line-number">1</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k1_ord1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k1_ord2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Net Rental Real Estate Income/Loss</td>
            <td class="line-number">2/3</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k1_rent1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k1_rent2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Other Net Rental Income/Loss</td>
            <td class="line-number">&mdash;</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k1_other1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k1_other2" value="0" oninput="calculate()"></td>
          </tr>
        </tbody>
      </table>

      <div class="corp-results">
        <div class="corp-result-item">
          <div class="label">Year 1 Income</div>
          <div class="value" id="k1_yr1">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Year 2 Income</div>
          <div class="value" id="k1_yr2">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Monthly Income</div>
          <div class="value" id="k1_month">$0.00</div>
        </div>
      </div>
    </div>

    <!-- K-1 #2 -->
    <div class="calc-section">
      <h2>K-1 #2 (Optional)</h2>
      <p class="text-muted text-sm" style="margin-bottom: var(--space-sm);">Use this section if the borrower has a second K-1 from another S-Corporation.</p>

      <table class="income-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>Line #</th>
            <th>Sign</th>
            <th>Year 1 (Most Recent)</th>
            <th>Year 2 (Prior)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Ordinary Business Income or Loss</td>
            <td class="line-number">1</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k2_ord1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k2_ord2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Net Rental Real Estate Income/Loss</td>
            <td class="line-number">2/3</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k2_rent1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k2_rent2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Other Net Rental Income/Loss</td>
            <td class="line-number">&mdash;</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k2_other1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k2_other2" value="0" oninput="calculate()"></td>
          </tr>
        </tbody>
      </table>

      <div class="corp-results">
        <div class="corp-result-item">
          <div class="label">Year 1 Income</div>
          <div class="value" id="k2_yr1">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Year 2 Income</div>
          <div class="value" id="k2_yr2">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Monthly Income</div>
          <div class="value" id="k2_month">$0.00</div>
        </div>
      </div>
    </div>

    <!-- K-1 #3 -->
    <div class="calc-section">
      <h2>K-1 #3 (Optional)</h2>
      <p class="text-muted text-sm" style="margin-bottom: var(--space-sm);">Use this section if the borrower has a third K-1 from another S-Corporation.</p>

      <table class="income-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>Line #</th>
            <th>Sign</th>
            <th>Year 1 (Most Recent)</th>
            <th>Year 2 (Prior)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Ordinary Business Income or Loss</td>
            <td class="line-number">1</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k3_ord1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k3_ord2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Net Rental Real Estate Income/Loss</td>
            <td class="line-number">2/3</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k3_rent1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k3_rent2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Other Net Rental Income/Loss</td>
            <td class="line-number">&mdash;</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k3_other1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k3_other2" value="0" oninput="calculate()"></td>
          </tr>
        </tbody>
      </table>

      <div class="corp-results">
        <div class="corp-result-item">
          <div class="label">Year 1 Income</div>
          <div class="value" id="k3_yr1">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Year 2 Income</div>
          <div class="value" id="k3_yr2">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Monthly Income</div>
          <div class="value" id="k3_month">$0.00</div>
        </div>
      </div>
    </div>

    <!-- K-1 #4 -->
    <div class="calc-section">
      <h2>K-1 #4 (Optional)</h2>
      <p class="text-muted text-sm" style="margin-bottom: var(--space-sm);">Use this section if the borrower has a fourth K-1 from another S-Corporation.</p>

      <table class="income-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>Line #</th>
            <th>Sign</th>
            <th>Year 1 (Most Recent)</th>
            <th>Year 2 (Prior)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Ordinary Business Income or Loss</td>
            <td class="line-number">1</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k4_ord1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k4_ord2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Net Rental Real Estate Income/Loss</td>
            <td class="line-number">2/3</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k4_rent1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k4_rent2" value="0" oninput="calculate()"></td>
          </tr>
          <tr>
            <td>Other Net Rental Income/Loss</td>
            <td class="line-number">&mdash;</td>
            <td class="sign-col add">+/&minus;</td>
            <td><input type="number" id="k4_other1" value="0" oninput="calculate()"></td>
            <td><input type="number" id="k4_other2" value="0" oninput="calculate()"></td>
          </tr>
        </tbody>
      </table>

      <div class="corp-results">
        <div class="corp-result-item">
          <div class="label">Year 1 Income</div>
          <div class="value" id="k4_yr1">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Year 2 Income</div>
          <div class="value" id="k4_yr2">$0.00</div>
        </div>
        <div class="corp-result-item">
          <div class="label">Monthly Income</div>
          <div class="value" id="k4_month">$0.00</div>
        </div>
      </div>
    </div>

    <!-- Combined Results -->
    <div class="calc-section">
      <h2>Combined Results</h2>

      <div class="results-grid">
        <div class="result-card">
          <div class="result-card__label">K-1 #1</div>
          <div class="result-card__value" id="resultK1">$0.00</div>
        </div>
        <div class="result-card">
          <div class="result-card__label">K-1 #2</div>
          <div class="result-card__value" id="resultK2">$0.00</div>
        </div>
        <div class="result-card">
          <div class="result-card__label">K-1 #3</div>
          <div class="result-card__value" id="resultK3">$0.00</div>
        </div>
        <div class="result-card">
          <div class="result-card__label">K-1 #4</div>
          <div class="result-card__value" id="resultK4">$0.00</div>
        </div>
      </div>

      <div class="result-highlight" style="margin-top: var(--space-lg);">
        <div class="result-highlight__label">Total Monthly K-1 Income</div>
        <div class="result-highlight__value" id="combinedK1">$0.00</div>
      </div>

      <div class="action-bar">
        <button type="button" class="btn btn-secondary" onclick="exportCSV()">Export CSV</button>
        <button type="button" class="btn btn-secondary" onclick="window.print()">Print</button>
        <button type="button" class="btn btn-ghost" onclick="clearAll()">Clear All</button>
      </div>
    </div>

    <%- include('../../partials/show-calculations', { calcId: 'income-1120s-k1' }) %>

  </div>

  <div class="calc-page__footer">
    <div class="calc-page__footer-title">K-1 (1120S) Guidelines</div>
    <p>
      S-Corporation income passes through to shareholders via Schedule K-1 (Form 1120S).
      Qualifying income includes ordinary business income/loss (Line 1) and rental
      income/loss (Lines 2/3). S-Corporation shareholders receive compensation as W-2
      wages rather than guaranteed payments. If two years are provided and Year 1
      exceeds Year 2, income is averaged over 24 months. Otherwise, only the most
      recent year is used (Year 1 / 12).
    </p>
  </div>
</div>
