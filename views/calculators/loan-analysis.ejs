<script>
  window.__emailSignature = <%- JSON.stringify(typeof site !== 'undefined' && site.emailSignature ? site.emailSignature : {}) %>;
  window.__companyLogo = '<%= typeof site !== "undefined" ? site.logo.src : "/images/msfg-logo.png" %>';
  window.__companyName = '<%= typeof site !== "undefined" ? site.companyName : "MSFG" %>';
</script>

<div class="calc-page">
  <div class="calc-page__header">
    <h1>Cover Letter</h1>
    <p>Create a professional cover letter for loan presentations. Edit the body text directly, then generate a polished letter.</p>
  </div>

  <div class="calc-page__body">

    <!-- Borrower Info (auto-filled from MISMO) -->
    <div class="calc-section">
      <h2>Borrower</h2>
      <div class="form-grid">
        <div class="form-group">
          <label for="laBorrowerName">Borrower Name</label>
          <input type="text" id="laBorrowerName" placeholder="e.g. John Smith">
        </div>
        <div class="form-group">
          <label for="laCoBorrowerName">Co-Borrower Name</label>
          <input type="text" id="laCoBorrowerName" placeholder="(optional)">
        </div>
      </div>
      <div class="form-grid" style="margin-top: var(--space-md);">
        <div class="form-group">
          <label for="laStreet">Street Address</label>
          <input type="text" id="laStreet" placeholder="123 Main St">
        </div>
        <div class="form-group">
          <label for="laCity">City</label>
          <input type="text" id="laCity" placeholder="Denver">
        </div>
      </div>
      <div class="form-grid" style="margin-top: var(--space-md);">
        <div class="form-group">
          <label for="laState">State</label>
          <input type="text" id="laState" placeholder="CO">
        </div>
        <div class="form-group">
          <label for="laZip">Zip Code</label>
          <input type="text" id="laZip" placeholder="80202">
        </div>
      </div>
    </div>

    <!-- Letter Body -->
    <div class="calc-section">
      <h2>Letter Body</h2>
      <div class="form-group">
        <label for="laBody">Write or edit the body of your cover letter</label>
        <textarea id="laBody" rows="12" style="width: 100%; resize: vertical; line-height: 1.7; font-size: 0.95rem;"></textarea>
      </div>
    </div>

    <!-- Attached Calculators (optional) -->
    <div class="calc-section">
      <h2>Attached Reports <span class="la-optional-badge">Optional</span></h2>
      <p class="la-attach-hint">Select which session report items to list as attachments on the letter. Leave all unchecked to omit this section.</p>
      <div id="laAttachList" class="la-attach-list">
        <p class="la-attach-empty">No items in session report yet. Add calculators to your session from the workspace first.</p>
      </div>
    </div>

    <!-- Hidden fields for MISMO LO data override -->
    <input type="hidden" id="laLoName">
    <input type="hidden" id="laLoNmls">
    <input type="hidden" id="laLoPhone">
    <input type="hidden" id="laLoEmail">
    <input type="hidden" id="laLoCompany">

    <!-- Action Bar -->
    <div class="action-bar" style="border-top: none;">
      <button class="btn btn-secondary" id="laResetBtn" type="button">Reset</button>
      <button class="btn btn-primary" id="laGenerateBtn" type="button">Generate Cover Letter</button>
    </div>

    <!-- Cover Letter Preview -->
    <div id="laResults" class="la-letter-preview" style="display: none;">
      <div class="la-letter" id="laLetterContent">
        <!-- Populated by generate() -->
      </div>
    </div>

  </div>
</div>
